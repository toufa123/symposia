!function(h){window.onLoadPPReCaptcha=function(){var r,e=h(".pp-grecaptcha");0<e.length&&e.each(function(e){var s=h(this),i=s.attr("data-widgetid"),t=h(this).attr("id");typeof i!=typeof undefined&&!1!==i||(s.attr("id",t),r=grecaptcha.render(t,{sitekey:s.data("sitekey"),theme:s.data("theme"),size:s.data("validate"),callback:function(e){""!=e&&(s.attr("data-pp-grecaptcha-response",e),"invisible"==s.data("validate")&&s.closest(".elementor-widget").find(".pp-submit-button").trigger("click"))}}),s.attr("data-widgetid",r))})},PPRegistrationForm=function(e,s){this.settings=s,this.nodeClass=e,this.i18n=s.i18n,this.messages=s.i18n.messages,this.form=h(this.nodeClass).find(".pp-registration-form"),this.fields={},this.errorCodes={},this._init()},PPRegistrationForm.prototype={settings:{},nodeClass:"",messages:{},isValid:!0,fields:{},errorCodes:{},_init:function(){this.form.length<1||(this._initFields(),this._bindErrorCodes(),this._bindEvents(),this._initReCaptcha())},_initReCaptcha:function(){var e=this.nodeClass.find(".pp-grecaptcha");elementorFrontend.isEditMode()&&undefined==e.attr("data-widgetid")&&onLoadPPReCaptcha()},_initFields:function(){this.fields={user_login:this.form.find('.pp-rf-field[data-field-type="user_login"]'),user_email:this.form.find('.pp-rf-field[data-field-type="user_email"]'),user_pass:this.form.find('.pp-rf-field[data-field-type="user_pass"]'),confirm_user_pass:this.form.find('.pp-rf-field[data-field-type="confirm_user_pass"]'),user_url:this.form.find('.pp-rf-field[data-field-type="user_url"]'),first_name:this.form.find('.pp-rf-field[data-field-type="first_name"]'),last_name:this.form.find('.pp-rf-field[data-field-type="last_name"]'),consent:this.form.find('.pp-rf-field[data-field-type="consent"]'),recaptcha:this.form.find('.pp-rf-field[data-field-type="recaptcha"]')},Object.keys(this.fields).forEach(h.proxy(function(e){var s;void 0===e||0<(s=this.fields[e].find('.pp-rf-control[name="'+e+'"]')).length&&(this.fields[e].control=s)},this))},_bindErrorCodes:function(){this.errorCodes={empty_email:"user_email",invalid_email:"user_email",email_exists:"user_email",username_wp_error:"user_login",invalid_username:"user_login",username_exists:"user_login",password:"user_pass",password_mismatch:"confirm_user_pass",invalid_url:"user_url",recaptcha_php_ver:"recaptcha",recaptcha_missing_key:"recaptcha"}},_bindEvents:function(){0<this.fields.user_pass.find(".pp-rf-toggle-pw").length&&this.fields.user_pass.find(".pp-rf-toggle-pw").on("click",h.proxy(this._passwordToggle,this)),this.settings.pws_meter&&"undefined"!=typeof wp.passwordStrength&&this.fields.user_pass.control.on("input",h.proxy(this._beginPwsMeter,this)),this.nodeClass.find(".pp-button").on("click",h.proxy(this._submit,this))},_getFieldByCode:function(e){if("undefined"==typeof this.errorCodes[e])return!1;e=this.errorCodes[e];return this.fields[e]},_getFormData:function(){var e=new FormData(this.nodeClass.find(".pp-registration-form")[0]);return e.append("referrer",location.toString()),e},_passwordToggle:function(){var e=this.fields.user_pass;"text"===e.control.attr("type")?(e.control.attr("type","password"),e.find(".pp-rf-toggle-pw").attr("aria-label",this.i18n.pw_toggle_text.show).find("span").removeClass("fa-eye-slash").addClass("fa-eye")):(e.control.attr("type","text"),e.find(".pp-rf-toggle-pw").attr("aria-label",this.i18n.pw_toggle_text.hide).find("span").removeClass("fa-eye").addClass("fa-eye-slash"))},_beginPwsMeter:function(e){var s=h(e.target).val(),i=this.fields.user_pass.find(".pp-rf-pws-status"),e=wp.passwordStrength.userInputBlacklist();switch(this.fields.confirm_user_pass.length,i.removeClass("short bad good strong"),wp.passwordStrength.meter(s,e,!1)){case 0:i.addClass("short").html(pwsL10n["short"]);break;case 1:i.addClass("bad").html(pwsL10n.bad);break;case 2:case 3:i.addClass("good").html(pwsL10n.good);break;case 4:i.addClass("strong").html(pwsL10n.strong)}""===s?i.removeClass("short bad good strong").html(""):this._removeErrorClass(this.fields.user_pass)},_submit:function(e){this.isValid=!0;var i,s,t,r=this.form,a=this.nodeClass.find(".pp-button"),d=this._getFormData(),n=this.nodeClass.find(".pp-grecaptcha"),o=n.data("pp-grecaptcha-response"),l=this.settings.ajaxurl,p=r.closest(".pp-rf-wrap").data("post-id"),f=(r.data("template-id"),r.data("template-node-id"),r.closest(".elementor-widget-pp-registration-form").data("id"));e.preventDefault(),a.hasClass("pp-disabled")||(r.find(".pp-rf-field").removeClass("pp-rf-field-error"),i=this,r.find(".pp-rf-field.elementor-mark-required").each(function(){var e=h(this),s=e.data("field-type"),s=h(this).find('[name="'+s+'"]');0<s.length&&("checkbox"===s.attr("type")||"radio"===s.attr("type")?s.is(":checked")?i._fieldHasError(e)&&i._removeErrorClass(e):(i.isValid=!1,i._addErrorClass(e)):s.val()&&""!==s.val()?i._fieldHasError(e)&&i._removeErrorClass(e):(i.isValid=!1,i._addErrorClass(e)))}),0<this.fields.user_email.length&&(""===(s=this.fields.user_email.find('input[type="email"]')).val()?(this.isValid=!1,this._addErrorClass(this.fields.user_email)):/\S+@\S+\.\S+/.test(s.val())?this._fieldHasError(this.fields.user_email)&&this._removeErrorClass(this.fields.user_email):(this.isValid=!1,this._removeErrorClass(this.fields.user_email),this._addInlineError(this.fields.user_email,this.messages.error.invalid_email))),0<this.fields.user_pass.length&&""!==(t=this.fields.user_pass.control).val()&&t.val().length<this.settings.min_pass_length&&(this.isValid=!1,this._addInlineError(this.fields.user_pass,this.messages.error.password_length)),0<this.fields.confirm_user_pass.length&&(s=this.fields.confirm_user_pass.find('input[name="confirm_user_pass"]').val(),t=this.fields.user_pass.find('input[name="user_pass"]').val(),""!==s&&btoa(s)!==btoa(t)&&(this.isValid=!1,this._addInlineError(this.fields.confirm_user_pass,this.messages.error.password_mismatch))),0<n.length&&this.isValid&&(void 0===o||!1===o?"normal"==n.data("validate")?(this.isValid=!1,this._addErrorClass(this.fields.recaptcha)):"invisible"==n.data("validate")&&grecaptcha.execute(n.data("widgetid")):this._removeErrorClass(this.fields.recaptcha)),this.isValid&&(a.addClass("pp-disabled"),0<n.length&&d.append("recaptcha",!0),o&&d.append("recaptcha_response",o),d.append("node_id",f),d.append("action","ppe_register_user"),d.append("security",r.data("nonce")),d.append("post_id",p),h.ajax({url:l,type:"POST",dataType:"json",data:d,processData:!1,contentType:!1,success:h.proxy(this._submitComplete,this),error:this._onError})))},_submitComplete:function(e){var s,i,t=this.nodeClass.find(" .pp-rf-success-none");if("undefined"==typeof e.success||!0!==e.success)return h(this.nodeClass).find(".pp-button").removeClass("pp-disabled"),"undefined"!=typeof e.data.message?(i=e.data,s=this._getFieldByCode(i.code),i="undefined"!=typeof this.messages.error[i.code]?this.messages.error[i.code]:i.message,s&&0<s.length?this._addInlineError(s,i):(this.nodeClass.find(" .pp-rf-failed-error").html(i),this.nodeClass.find(" .pp-rf-failed-error").fadeIn())):this.nodeClass.find(" .pp-rf-failed-error").fadeIn(),!1;this.nodeClass.find(" .pp-rf-failed-error").fadeOut(),"yes"!==e.data.auto_login||"undefined"!=typeof e.data.redirect_url&&""!==e.dataredirect_url?"undefined"!=typeof e.data.redirect_url?window.location.href=e.data.redirect_url:0<t.length?t.fadeIn():(this.nodeClass.find(".pp-registration-form").hide(),this.nodeClass.find(".pp-after-submit-action.pp-rf-success").fadeIn()):window.location.reload()},_onError:function(e,s){console.log(s)},_addInlineError:function(e,s){e.find(".pp-rf-error-inline").remove(),e.addClass("pp-rf-field-error").append('<span class="pp-rf-error-inline">'+s+"</span>")},_addErrorClass:function(e){e.addClass("pp-rf-validation-error")},_removeErrorClass:function(e){e.removeClass("pp-rf-validation-error")},_fieldHasError:function(e){return e.hasClass("pp-rf-validation-error")}}}(jQuery);