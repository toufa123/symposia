!function(o){var i=["powerpack","pp_section","pp_column"],t=["widget","column","section"];xdLocalStorage.init({iframeUrl:pp_magic_wand.cross_domain_cdn,initCallback:function(){}}),PPMWHandler={copy:function(e,n){xdLocalStorage.setItem("ppe_container_new",JSON.stringify({widgetType:e,widgetCode:n}))},paste:function(e,n){var t=null,e=e.widgetCode,i=JSON.stringify(e),o={elType:e.elType,settings:e.settings},a=/\.(jpg|jpeg|png|gif|svg)/gi.test(i),r=n,c=n.model.get("elType"),d={index:0};switch(e.elType){case"section":switch(o.elements=PPMWHandler.generateUniqueID(e.elements),t=elementor.getPreviewContainer(),c){case"widget":d.index=r.getContainer().parent.parent.view.getOption("_index")+1;break;case"column":d.index=r.getContainer().parent.view.getOption("_index")+1;break;case"section":d.index=r.getOption("_index")+1}break;case"column":switch(o.elements=PPMWHandler.generateUniqueID(e.elements),c){case"widget":t=r.getContainer().parent.parent,d.index=r.getContainer().parent.view.getOption("_index")+1;break;case"column":t=r.getContainer().parent,d.index=r.getOption("_index")+1;break;case"section":t=r.getContainer()}break;case"widget":switch(o.widgetType=e.widgetType,t=r.getContainer(),c){case"widget":t=r.getContainer().parent,d.index=r.getOption("_index")+1;break;case"column":t=r.getContainer();break;case"section":t=r.children.findByIndex(0).getContainer()}}var p=PPMWHandler.createElement(r,c,{model:o,container:t,options:d});a&&PPMWHandler.processMedia(p,i,function(e){var n;e.success&&(e=e.data[0],o.elType=e.elType,o.settings=e.settings,"widget"===e.elType?o.widgetType=e.widgetType:o.elements=e.elements,p.view.$el.removeClass("ppe-processing-import").attr("data-pp-processing-import-title","Image processing completed."),n=setTimeout(function(){$e.run("document/elements/delete",{container:p}),$e.run("document/elements/create",{model:o,container:t,options:d}),clearTimeout(n)},750))})},createElement:function(e,n,t){t=$e.run("document/elements/create",t);return undefined==t&&("widget"===n?e.$el.next(".undefined.elementor-widget-empty")&&e.$el.next(".undefined.elementor-widget-empty").after('<div class="elementor-alert elementor-alert-warning">'+pp_magic_wand.widget_not_found+"</div>"):e.$el.find(".undefined.elementor-widget-empty")&&e.$el.find(".undefined.elementor-widget-empty").after('<div class="elementor-alert elementor-alert-warning">'+pp_magic_wand.widget_not_found+"</div>")),t},processMedia:function(e,n,t){o.ajax({url:pp_magic_wand.ajaxURL,method:"post",data:{nonce:pp_magic_wand.nonce,action:"pp_process_import",content:n},beforeSend:function(){e.view.$el.addClass("ppe-processing-import").attr("data-pp-processing-import-title","Processing images...")}}).done(function(e){"function"==typeof t&&t(e)})},generateUniqueID:function(e){return e.forEach(function(e,n){void 0!==elementorCommon.helpers.getUniqueId()&&(e.id=elementorCommon.helpers.getUniqueId()),0<e.elements.length&&PPMWHandler.generateUniqueID(e.elements)}),e},getSectionData:function(e,n,t,i){void 0!==e&&void 0!==n&&(void 0===t&&(t=1),o.post(pp_magic_wand.ajaxURL,{action:"pp_get_section_data",post_id:e,section_id:n,nonce:t},function(e){e.success&&PPMWHandler.copy("section",e.data),"function"==typeof i&&i(e)}))}},"undefined"!=typeof elementor&&i.forEach(function(e,n){elementor.hooks.addFilter("elements/"+t[n]+"/contextMenuGroups",function(e,t){return e.push({name:i[n],actions:[{name:"copy",title:pp_magic_wand.pp_copy,icon:pp_magic_wand.cross_domain_icon,callback:function(){var e=t.model.get("widgetType"),n=t.model.toJSON();PPMWHandler.copy(e,n)}},{name:"paste",title:pp_magic_wand.pp_paste,icon:pp_magic_wand.cross_domain_icon,callback:function(){var n;xdLocalStorage.getItem("ppe_container_new",function(e){n=JSON.parse(e.value),PPMWHandler.paste(n,t)})}}]}),e})})}(jQuery);