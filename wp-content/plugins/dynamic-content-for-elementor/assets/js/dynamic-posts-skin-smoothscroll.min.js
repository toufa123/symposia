var Widget_DCE_Dynamicposts_smoothscroll_Handler=function($scope,$){var smsc=null;var elementSettings=dceGetElementSettings($scope);var id_scope=$scope.attr('data-id');var smoothscroll_image_perspective=elementSettings[dceDynamicPostsSkinPrefix+'smoothscroll_image_perspective'];var smoothscroll_image_scale=elementSettings[dceDynamicPostsSkinPrefix+'smoothscroll_image_scale'];var smoothscroll_image_translatey=elementSettings[dceDynamicPostsSkinPrefix+'smoothscroll_image_translatey'];var smoothscroll_content_translatey=elementSettings[dceDynamicPostsSkinPrefix+'smoothscroll_content_translatey'];var smooothscroll=$scope.find('.dce-posts-container.dce-skin-smoothscroll');const MathUtils={map:(x,a,b,c,d)=>(x-a)*(d-c)/(b-a)+c,lerp:(a,b,n)=>(1-n)*a+n*b,getRandomFloat:(min,max)=>(Math.random()*(max-min)+min).toFixed(2)};const body=document.body;let winsize;const calcWinsize=()=>winsize={width:window.innerWidth,height:window.innerHeight};calcWinsize();window.addEventListener('resize',calcWinsize);let docScroll;let lastScroll;let scrollingSpeed=0;const getPageYScroll=()=>docScroll=window.pageYOffset||document.documentElement.scrollTop;window.addEventListener('scroll',getPageYScroll);var offset=$scope.find('.dce-smoothscroll-container').offset();class Item{constructor(el){this.DOM={el:el};if(this.DOM.el.querySelector('.dce-post-image')){this.DOM.image=this.DOM.el.querySelector('.dce-post-image');this.DOM.block=this.DOM.el.querySelector('.dce-post-block');this.DOM.block.style.perspective='1000px'}else{this.DOM.image=this.DOM.el.querySelector('.dce-post-block');this.DOM.block=this.DOM.el;this.DOM.block.style.perspective='1000px'}
this.DOM.imageWrapper=this.DOM.image.parentNode;if(this.DOM.el.querySelector('.dce-image-area')){this.DOM.imagearea=this.DOM.el.querySelector('.dce-image-area');this.DOM.imagearea.style.perspective='1000px'}
if(this.DOM.el.querySelector('.dce-content-area')){this.DOM.contentarea=this.DOM.el.querySelector('.dce-content-area');this.DOM.contentarea.style.perspective='1000px'}else{this.DOM.contentarea=this.DOM.el.querySelector('.dce-post-title')}
this.DOM.imageWrapper.style.transformOrigin='50% 100%';this.ry=MathUtils.getRandomFloat(-0.5,0.5);this.rz=MathUtils.getRandomFloat(-0.5,0.5);this.renderedStyles={innerTranslationY:{previous:0,current:0,ease:0.1,setValue:()=>{const toValue=parseInt(getComputedStyle(this.DOM.image).getPropertyValue('--overflow'),10);const fromValue=-1*toValue;return Math.max(Math.min(MathUtils.map(this.props.top-docScroll,winsize.height,-1*this.props.height,fromValue,toValue),toValue),fromValue)}},itemRotation:{previous:0,current:0,ease:0.1,toValue:Number(MathUtils.getRandomFloat(-70,-50)),setValue:()=>{const toValue=this.renderedStyles.itemRotation.toValue;const fromValue=toValue*-1;const val=MathUtils.map(this.props.top-docScroll,winsize.height*1.5,-1*this.props.height,fromValue,toValue);return Math.min(Math.max(val,toValue),fromValue)}},imageScale:{previous:0,current:0,ease:0.1,setValue:()=>{const toValue=1.5;const fromValue=1;const val=MathUtils.map(this.props.top-docScroll,winsize.height,-1*this.props.height,fromValue,toValue);return Math.max(Math.min(val,toValue),fromValue)}},itemTranslationY:{previous:0,current:0,ease:0.1,fromValue:Number(MathUtils.getRandomFloat(0,400)),setValue:()=>{const fromValue=this.renderedStyles.itemTranslationY.fromValue;const toValue=-1*fromValue;const val=MathUtils.map(this.props.top-docScroll,winsize.height,-1*this.props.height,fromValue,toValue);return fromValue<0?Math.min(Math.max(val,fromValue),toValue):Math.max(Math.min(val,fromValue),toValue)}}};this.getSize();this.update();this.observer=new IntersectionObserver((entries)=>{entries.forEach(entry=>this.isVisible=entry.intersectionRatio>0)});this.observer.observe(this.DOM.el);this.initEvents()}
update(){for(const key in this.renderedStyles){this.renderedStyles[key].current=this.renderedStyles[key].previous=this.renderedStyles[key].setValue()}
this.layout()}
getSize(){const rect=this.DOM.el.getBoundingClientRect();this.props={height:rect.height,top:docScroll+rect.top}}
initEvents(){window.addEventListener('resize',()=>this.resize())}
resize(){this.getSize();this.update()}
render(){for(const key in this.renderedStyles){this.renderedStyles[key].current=this.renderedStyles[key].setValue();this.renderedStyles[key].previous=MathUtils.lerp(this.renderedStyles[key].previous,this.renderedStyles[key].current,this.renderedStyles[key].ease)}
this.layout()}
layout(){var scale3d=smoothscroll_image_scale?`scale3d(${this.renderedStyles.imageScale.previous},${this.renderedStyles.imageScale.previous},1)`:'';var translate3d=smoothscroll_image_translatey?`translate3d(0,${this.renderedStyles.innerTranslationY.previous}px,0)`:'';this.DOM.image.style.transform=scale3d+translate3d;if(smoothscroll_image_perspective)this.DOM.imageWrapper.style.transform=`rotate3d(1,${this.ry},${this.rz},${this.renderedStyles.itemRotation.previous}deg)`;if(smoothscroll_content_translatey)this.DOM.contentarea.style.transform=`translate3d(0,${this.renderedStyles.itemTranslationY.previous}px,0)`}}
class SmoothScroll{constructor(){if(!$('#dce-smootscroll-main').length)
$('body').wrapInner('<div id="dce-smootscroll-main"><div id="dce-smootscroll-wrap-'+id_scope+'"></div></div>');var generatedWrap=$('#dce-smootscroll-main');this.DOM={main:generatedWrap[0]};this.DOM.scrollable=this.DOM.main.querySelector('#dce-smootscroll-wrap-'+id_scope);this.items=[];this.DOM.content=this.DOM.main.querySelector('.dce-smoothscroll-wrapper');[...this.DOM.content.querySelectorAll('.dce-smoothscroll-item')].forEach(item=>this.items.push(new Item(item)));this.renderedStyles={translationY:{previous:0,current:0,ease:0.1,setValue:()=>docScroll}};this.setSize();this.update();this.style();this.initEvents();requestAnimationFrame(()=>this.render())}
update(){for(const key in this.renderedStyles){this.renderedStyles[key].current=this.renderedStyles[key].previous=this.renderedStyles[key].setValue()}
this.layout()}
layout(){this.DOM.scrollable.style.transform=`translate3d(0,${-1*this.renderedStyles.translationY.previous}px,0)`}
setSize(){body.style.height=`${this.DOM.scrollable.scrollHeight}px`}
style(){this.DOM.main.style.position='fixed';this.DOM.main.style.width=this.DOM.main.style.height='100%';this.DOM.main.style.top=this.DOM.main.style.left=0;this.DOM.main.style.overflow='hidden'}
initEvents(){window.addEventListener('resize',()=>this.setSize())}
remove(){this.DOM.main.removeAttribute("style")}
render(){scrollingSpeed=Math.abs(docScroll-lastScroll);lastScroll=docScroll;for(const key in this.renderedStyles){this.renderedStyles[key].current=this.renderedStyles[key].setValue();this.renderedStyles[key].previous=MathUtils.lerp(this.renderedStyles[key].previous,this.renderedStyles[key].current,this.renderedStyles[key].ease)}
this.layout();for(const item of this.items){if(item.isVisible){if(item.insideViewport){item.render()}else{item.insideViewport=!0;item.update()}}else{item.insideViewport=!1}}
requestAnimationFrame(()=>this.render())}}
if(smooothscroll.length){getPageYScroll();lastScroll=docScroll;if(smsc)smsc.remove();smsc=new SmoothScroll()}};jQuery(window).on('elementor/frontend/init',function(){elementorFrontend.hooks.addAction('frontend/element_ready/dce-dynamicposts-v2.smoothscroll',Widget_DCE_Dynamicposts_smoothscroll_Handler);elementorFrontend.hooks.addAction('frontend/element_ready/dce-dynamic-woo-products.smoothscroll',Widget_DCE_Dynamicposts_smoothscroll_Handler);elementorFrontend.hooks.addAction('frontend/element_ready/dce-dynamic-show-favorites.smoothscroll',Widget_DCE_Dynamicposts_smoothscroll_Handler);elementorFrontend.hooks.addAction('frontend/element_ready/dce-my-posts.smoothscroll',Widget_DCE_Dynamicposts_smoothscroll_Handler);elementorFrontend.hooks.addAction('frontend/element_ready/dce-sticky-posts.smoothscroll',Widget_DCE_Dynamicposts_smoothscroll_Handler);elementorFrontend.hooks.addAction('frontend/element_ready/dce-search-results.smoothscroll',Widget_DCE_Dynamicposts_smoothscroll_Handler)})